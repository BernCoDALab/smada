<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>chapter – Statistical Methods for Archaeological Data Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Statistical Methods for Archaeological Data Analysis</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Overview</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../additional_information.html"> 
<span class="menu-text">Additional Information</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../schedule.html"> 
<span class="menu-text">Schedule</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../lectures.html"> 
<span class="menu-text">Lectures</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../comp_labs.html"> 
<span class="menu-text">Computer Labs</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../homework.html"> 
<span class="menu-text">Homework</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#nonparametric-tests" id="toc-nonparametric-tests" class="nav-link active" data-scroll-target="#nonparametric-tests">Nonparametric Tests</a>
  <ul class="collapse">
  <li><a href="#inductive-statistics-or-statistical-inference" id="toc-inductive-statistics-or-statistical-inference" class="nav-link" data-scroll-target="#inductive-statistics-or-statistical-inference">Inductive statistics or statistical inference</a></li>
  <li><a href="#population-and-sample" id="toc-population-and-sample" class="nav-link" data-scroll-target="#population-and-sample">Population and sample</a>
  <ul class="collapse">
  <li><a href="#repetition" id="toc-repetition" class="nav-link" data-scroll-target="#repetition">Repetition:</a></li>
  <li><a href="#parameter" id="toc-parameter" class="nav-link" data-scroll-target="#parameter">Parameter</a></li>
  </ul></li>
  <li><a href="#statistical-hypothesis-testing" id="toc-statistical-hypothesis-testing" class="nav-link" data-scroll-target="#statistical-hypothesis-testing">Statistical Hypothesis testing</a>
  <ul class="collapse">
  <li><a href="#validation-of-an-assumption-about-the-population" id="toc-validation-of-an-assumption-about-the-population" class="nav-link" data-scroll-target="#validation-of-an-assumption-about-the-population">Validation of an assumption about the population</a></li>
  <li><a href="#null-hypothesis" id="toc-null-hypothesis" class="nav-link" data-scroll-target="#null-hypothesis">Null hypothesis</a></li>
  <li><a href="#one-tailedtwo-tailed-hypothesis" id="toc-one-tailedtwo-tailed-hypothesis" class="nav-link" data-scroll-target="#one-tailedtwo-tailed-hypothesis">One-tailed/Two-tailed hypothesis</a></li>
  <li><a href="#stat.-significance" id="toc-stat.-significance" class="nav-link" data-scroll-target="#stat.-significance">Stat. Significance</a></li>
  <li><a href="#how-true-is-true" id="toc-how-true-is-true" class="nav-link" data-scroll-target="#how-true-is-true">How true is true?</a></li>
  </ul></li>
  <li><a href="#α--und-β-error" id="toc-α--und-β-error" class="nav-link" data-scroll-target="#α--und-β-error">α- und β-error</a></li>
  <li><a href="#parametric-vs.-nonparametric" id="toc-parametric-vs.-nonparametric" class="nav-link" data-scroll-target="#parametric-vs.-nonparametric">Parametric vs.&nbsp;Nonparametric</a></li>
  <li><a href="#chi2-test" id="toc-chi2-test" class="nav-link" data-scroll-target="#chi2-test"><span class="math inline">\(\chi^2\)</span> test</a>
  <ul class="collapse">
  <li><a href="#facts-sheet" id="toc-facts-sheet" class="nav-link" data-scroll-target="#facts-sheet">Facts sheet</a></li>
  <li><a href="#excursus-degree-of-freedom" id="toc-excursus-degree-of-freedom" class="nav-link" data-scroll-target="#excursus-degree-of-freedom">Excursus degree of freedom</a></li>
  <li><a href="#chi2-test-for-one-sample-example-after-shennan" id="toc-chi2-test-for-one-sample-example-after-shennan" class="nav-link" data-scroll-target="#chi2-test-for-one-sample-example-after-shennan"><span class="math inline">\(\chi^2\)</span> Test for one sample (example after Shennan)</a></li>
  <li><a href="#two-sample-case-test-for-independence" id="toc-two-sample-case-test-for-independence" class="nav-link" data-scroll-target="#two-sample-case-test-for-independence">Two sample case (Test for independence)</a></li>
  </ul></li>
  <li><a href="#kolmogorovsmirnov-test" id="toc-kolmogorovsmirnov-test" class="nav-link" data-scroll-target="#kolmogorovsmirnov-test">Kolmogorov–Smirnov test</a>
  <ul class="collapse">
  <li><a href="#facts-sheet-ks-test" id="toc-facts-sheet-ks-test" class="nav-link" data-scroll-target="#facts-sheet-ks-test">Facts sheet KS-Test</a></li>
  <li><a href="#example-after-shennan" id="toc-example-after-shennan" class="nav-link" data-scroll-target="#example-after-shennan">Example (after Shennan)</a></li>
  <li><a href="#ks-test-in-r" id="toc-ks-test-in-r" class="nav-link" data-scroll-target="#ks-test-in-r">KS-Test in R</a></li>
  </ul></li>
  <li><a href="#interpretation-of-significance-tests" id="toc-interpretation-of-significance-tests" class="nav-link" data-scroll-target="#interpretation-of-significance-tests">Interpretation of significance tests</a>
  <ul class="collapse">
  <li><a href="#pay-attention-also-when-the-statistic-seem-to-be-clear" id="toc-pay-attention-also-when-the-statistic-seem-to-be-clear" class="nav-link" data-scroll-target="#pay-attention-also-when-the-statistic-seem-to-be-clear">Pay attention also when the statistic seem to be clear</a></li>
  <li><a href="#statistical-association-not-mean-causal-association" id="toc-statistical-association-not-mean-causal-association" class="nav-link" data-scroll-target="#statistical-association-not-mean-causal-association">Statistical association not mean causal association!</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">




<section id="nonparametric-tests" class="level1">
<h1>Nonparametric Tests</h1>
<section id="inductive-statistics-or-statistical-inference" class="level2">
<h2 class="anchored" data-anchor-id="inductive-statistics-or-statistical-inference">Inductive statistics or statistical inference</h2>
<p>Until now, we have primarily described and presented the data of our sample using descriptive statistics and graphical visualisation. We also used graphical visualisations to explore our dataset in the sense of explorative statistics. In all of these techniques, we stayed on the page of the sample. We did not make any conclusions about the underlying population.</p>
<p>This is no different, when we come to the field of inductive statistics, or statistical inference. Here, we explicitly try to estimate characteristics of our population using our sample. Since in nearly all cases, our sample will be smaller (in archaeology actually very much smaller) then our population, we have only access to a small part of the information describing the full population. So necessarily, when we base our estimation only on a fraction of the population, our estimation will be wrong. But it doesn’t need to be true, it just needs to be sufficiently correct. Nevertheless, it is essential to keep that in mind: whatever comes out of the statistical analyses, only is to with a certain probability. The knowledge gained is always statistical meaning, there is a certain chance that the world is like we assume it. We have to have a link from the sample that we have at hand, to the population. This link is provided to us by probability theory. We will explain that a bit more detailed, when it comes to parametric tests.</p>
</section>
<section id="population-and-sample" class="level2">
<h2 class="anchored" data-anchor-id="population-and-sample">Population and sample</h2>
<section id="repetition" class="level3">
<h3 class="anchored" data-anchor-id="repetition">Repetition:</h3>
<p>A small repetition of what we have learnt in the beginning: We call <strong>population</strong> the collection of all items that are relevant for our investigation. But in most cases, we cannot investigate the full population. Therefore we investigate only a fraction of it. This fraction, that we ideally select on certain criteria (represent activity), is called our <strong>sample</strong>. We always should keep in mind, that the dataset that we are analysing is only a random selection of the whole collection of items that we are really interested in. In so far, it is like our probe that we send out as spaceship Enterprise into the nebula of data that lie in front of us. This is especially true in archaeology, where neither the population nor the conditions under which our sample is created is under our control. We never will be able to access the population, and we never will be able to verify our interpretation with it.</p>
</section>
<section id="parameter" class="level3">
<h3 class="anchored" data-anchor-id="parameter">Parameter</h3>
<p>Even if we have no way of precisely knowing them, our population always has certain values or distributions of values, there are fixed. For example, there is a specific value for the mean foot length of all the La Tène B fibulae ever produced (given, that we can agree on what a La Tène B fibula is). This value is there. It is an actual number. But we never will know it, and it’s lost in the depth of time.</p>
<p>Such variables, that we can’t be sure exists and have a certain value we call <strong>parametres</strong>. This parameters can only be estimated by us using the sample. So, they are not accessible for us, nevertheless that they really exist and really have a specific value.</p>
<p>Also, samples have parammeters. But these parameters are accessible: we can measure them. But we have to distinguish these parameters from the actual parameters of the population. Quite often, this is already visible in the notation that is used in the formula, which differentiate between sample and population. For example:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Population</th>
<th style="text-align: center;">Sample</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\mu:\)</span> mean of the population</td>
<td style="text-align: center;"><span class="math inline">\(\bar{x}\)</span>: mean of the sample</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\sigma\)</span>: standard deviation of the population</td>
<td style="text-align: center;"><span class="math inline">\(s\)</span>: standard deviation of the sample</td>
</tr>
</tbody>
</table>
<p>Since we can only measure the parameters of the sample, we use them, and some knowledge about the general distribution of values in random processes, to estimate those values of the population. This is done in statistical tests, where it is estimated, if and how likely certain values of a sample, under certain conditions of a random process, result from the population with a certain parameter. The quality of the statement of a test therefore depends on the choice of the sample (representativity)! For this, we make a hypothesis about the value of the population, and then we test this hypothesis using statistical hypothesis testing.</p>
</section>
</section>
<section id="statistical-hypothesis-testing" class="level2">
<h2 class="anchored" data-anchor-id="statistical-hypothesis-testing">Statistical Hypothesis testing</h2>
<section id="validation-of-an-assumption-about-the-population" class="level3">
<h3 class="anchored" data-anchor-id="validation-of-an-assumption-about-the-population">Validation of an assumption about the population</h3>
<p>As I have just explained, does statistical hypothesis testing takes place before the background of the sample. We make a hypothesis about the value of the parameter of the population, and then we estimate, how likely the sample that we have at hand could have resulted from such a population. If it is very likely, then it is an indication that our hypothesis is not too bad. If it is very unlikely, that might be indication that there is something wrong with our hypothesis.</p>
<p>Before we start to talk about actual and individual values, most of the time hypothesis actually unfold them self more as general questions like the one below:</p>
<p><strong>How probable is it that two or more samples descend from the different/the same population?</strong></p>
<p>(eg. Is the custom of grave goods for man and women so different that two different social groups are visible?)</p>
<p><strong>How probable is it that a given sample descend from a population with certain parameters?</strong></p>
<p>(Is the amount of grave goods random or is a pattern visible?)</p>
<p>In the first place, when we have two samples and try to estimate if they originate from the same or from different populations, we have a test for independence. That means, we test, based on the samples, if the population of both values are independent from each other or not. In the second case, which is also called goodness of fit test, we test how good our data fits to a specific assumption, like I have explained above. But it is very difficult to prove something about the population, given that we have a sample. Maybe, we just have to wrong sample? Maybe, while our sample just doesn’t fit to our assumption, the sample next to it would probably do. It is much easier to falsifier statement using a sample: only one black swan falsifies do you hypothesis, that all swans are white. Therefore, in statistical hypothesis testing, we use a detour over falsification to make our hypothesis more plausible. This detour is called null-hypothesis.</p>
</section>
<section id="null-hypothesis" class="level3">
<h3 class="anchored" data-anchor-id="null-hypothesis">Null hypothesis</h3>
<p>In statistical tests most of the times not the statement is tested which one expects to be true, but one tries to disprove the statement which one expects to be wrong: the null hypothesis. This hypothesis states mostly, that a association do not exists or that there is no differences between the samples and the distribution of the observations is by chance. So, most of the time, it is the rather boring standard situation, that exciting scientific investigations try to disprove.</p>
<p>An example: Is the composition of grave goods different between male and female deceased?</p>
<p>This is the scientific question. Now, there are two possible answers to that, resulting into possible hypothesis:</p>
<p><span class="math inline">\(H_0\)</span>: The composition is the same</p>
<p><span class="math inline">\(H_1\)</span>: The composition is different</p>
<p>So instead of proving our hypothesis one, we try to disprove or falsify its opposite. When we have shown, that the assumption, that the composition is the same (or only different due to random chance), then we have shown at the same time, that the composition is different. We did not say anything about how it is different, or why it is different, we only state, that is different. As we have shown above, this has two reasons:</p>
<ol type="1">
<li>It is (logical) easier to prove, that a statement is wrong (falsify) then to prove that a statement is true (verify).</li>
<li>Most of the times it is easier to formulate a null hypothesis (How exactly is the composition different?). It doesn’t make a assumption about how the character of a association/difference exactly is.</li>
</ol>
<p>So the “workflow” of the statistical test is the following: At first, usually from our scientific question, we have our alternative hypothesis. At the moment, it is probably not with an alternative, because it is the only hypothesis that we have. Usually, we hope or expect to find something interesting in the data. For example in relation to gender differences in burial items:</p>
<p><strong>Construction of a alternative hypothesis:</strong></p>
<p>The composition of the grave goods is different between male and female deceased.</p>
<p>From this assumption, we build our no hypothesis in such a way that we are stating the opposite of what we might expect:</p>
<p><strong>Construction of the null hypothesis:</strong></p>
<p>The composition of the grave goods is the same in male and female burials.</p>
<p>[To be honest, this is a bit of cheating. If you get further into the discussion about the validity of statistical analyses, you will learn decides to discussion on the P value as such, that one should actually only compare real scientific hypothesis with each other, and not such a strawman like another hypothesis. Nevertheless, this is (quite successful) practice in frequentist statistical analyses since decades, and in most of the time it actually also works quite well. Only to let you know, that this is not the only way of how you can interpret this workflow.]</p>
<p>Now, that we have our normal hypothesis, we can test with our data from our sample how likely it is. How do you specifically is done, depends very much on the statistical test that we are using, and the data quality, that we are investigating. But the general logic is always the same: the next step is the</p>
<p><strong>Test of the null hypothesis</strong></p>
<p>From this, we have two possible results. Either:</p>
<p><strong>If the result of the test is significant:</strong></p>
<p>Then we have evidence, that our Null Hypothesis might not be true. And, depending on the level of security that we would like to have, this might be rather overwhelming evidence. In that case, we reject the null hypothesis. This also means, that we can choose the alternative hypothesis. In our example:</p>
<p>The composition of the grave goods is different between male and female deceased.</p>
<p>If the result of the test is not significant, This means, that we do not have enough evidence to securely falsify the null hypothesis. Or in other words:</p>
<p><strong>The null hypothesis could not be rejected.</strong></p>
<p>This now does not mean, get the null hypothesis is actually true. You see that quite often, that When statistical test is not significant, that interpretation is that there is no difference for example between two populations. But this is not correct because the null hypothesis can be kept Ivor, because it’s true (or better not wrong), or, because there are not enough data. Statistical significance doesn’t and cannot differentiate between these two possibilities.</p>
</section>
<section id="one-tailedtwo-tailed-hypothesis" class="level3">
<h3 class="anchored" data-anchor-id="one-tailedtwo-tailed-hypothesis">One-tailed/Two-tailed hypothesis</h3>
<p>Sometimes, you see one-tailed or two-tailed as qualifier resulting from statistical tests. This comes from the fact that technically in most of the hypothesis testing we compare our value to a range of theoretical values. In such situations, our value can be bigger or smaller than this range. Now, it depends on the question asked and therefore on the hypothesis, in which case we can reject our null hypothesis. Probably can be best explained using example:</p>
<p><em>Is the number of grave goods in female burials higher than in male?</em></p>
<p>With this type of question, there is only one way in which our hypothesis (or it’s null hypothesis) can be falsified. Only in the case, when the number of greatcoats in May burials are higher, then we have a falsification of our hypothesis. There is only one way, one tail of the values, on which it can be falsified.</p>
<p><em>Is the number of grave goods in female burials different from male?</em></p>
<p>Here, the number of grave goods in female burials can differ into directions: There can be more or less burial items. So on both tails of our value range (smaller, bigger) there is falsification of the null hypothesis possible. Therefore, this is a two-tailed hypothesis.</p>
<p>Here, we have more chance for a random process to result in the pattern that we are observing. That’s why in statistical tests the result is often two significances (onetailed, two-tailed). .center[ <img src="../images/05_session/cm_fig2d.png" class="img-fluid" alt=":width 25%"> <img src="../images/05_session/cm_fig2c.png" class="img-fluid" alt=":width 25%">]</p>
</section>
<section id="stat.-significance" class="level3">
<h3 class="anchored" data-anchor-id="stat.-significance">Stat. Significance</h3>
</section>
<section id="how-true-is-true" class="level3">
<h3 class="anchored" data-anchor-id="how-true-is-true">How true is true?</h3>
<p>Now, we quite often have used the term significant. Of course, in common language this means important. In the realm of statistical analyses, significance means a measure of how certain decision for one or the other hypothesis is. Or, to put it the other way round, it is a measure of uncertainty.</p>
<p>We have already introduced the null hypothesis, and there we have explained that statistical significance decides whether or not to accept the null hypothesis. More specifically, significance is exactly a measure of how probable an error is when we reject the null hypothesis. That is not directly the same as how likely the null hypothesis itself is, although quite often it will be mixed up with this meaning. One important factor in this difference is, that also sample size and with that certainty of evidence against the null hypothesis is factored in here. But from this perspective, it also makes quiet sense that based on this criterion the null hypothesis is rejected or not. This measure of course is a continuous variable, so there are no specific values per se that would define a threshold. Nevertheless, there are some arbitrary classical thresholds:</p>
<ul>
<li>0.05: significant, with 95% probability the decision is right.</li>
<li>0.01: very significant, with 99% probability the decision is right.</li>
<li>0.001: highly significant, with 99,9% probability the decision is right.</li>
</ul>
<p>In archaeology, where no life depends on our decision, usually the 0.05 level is perfectly fine for decision-making. In medical trial or situations, where you have a lot of experimental data, you probably would like to have stricter significance levels than that. But technically, no one can stop you to introduce your own significance level if you like.</p>
<p>This measure of significance is also often called p-value in the literature in the English literature, or alpha (<span class="math inline">\(\alpha\)</span>) in other languages. If you look up these names, you probably will find that there is quite a discussion going on about the value of the p-value in scientific analyses. Since this year it’s a beginners course, we will not go into this debate. For us the p-value is significant enough, and we will stick to this arbitrary 0.05 measure. This measure also means, that in 1 out of 20 cases the null hypothesis will be rejected even though it should not be rejected. When interpreting statistical results, one should always keep this in mind: even with seemingly objective statistical methods, there is quite a big margin of error possible. Actually, there are two possible arrows here: we can except the null hypothesis, even if it is not true. Or, we can reject the null hypothesis even if it is true. We will learn about these two versions in the next section.</p>
</section>
</section>
<section id="α--und-β-error" class="level2">
<h2 class="anchored" data-anchor-id="α--und-β-error">α- und β-error</h2>
<p>As I have described above, we can go wrong in two ways with the rejection of a null hypothesis in statistical investigations:</p>
<p><strong>The null hypothesis is rejected although it is true</strong> -&gt; <em>Type I error, false positive, <span class="math inline">\(\alpha\)</span>-error</em></p>
<p>Such an error would be, for example, when the result of a pregnancy test shows a pregnancy although there is none.</p>
<p><strong>The null hypothesis is not rejected although it is wrong</strong> -&gt; <em>Type II error, false negative, <span class="math inline">\(\beta\)</span>-error</em></p>
<p>In this situation, the example would be the result of a pregnancy test if it shows no pregnancy although there is one.</p>
<p>So in general, there are two situations where we can decide correct: If we accept the null hypothesis, and it is the correct choice, or we reject the null hypothesis, and that is the correct choice. If we reject the null hypothesis, but there is in reality no difference between our samples, then we make this type one error. In that case, we would think that we gained some new knowledge, so we probably will build further interpretations on top of that. That makes type one errors more severe. Because, with a Type II error, when we keep the null hypothesis although there is a difference in our data justifying the alternative hypothesis, if we correctly interpret the statistical results we just miss an opportunity to find an interesting pattern. When another hypothesis cannot be rejected, we should not learn anything about the population.So, not so much damage should result from that.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>True condition: H0 (There is no difference)</th>
<th>True condition: H1 (There is a difference)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>By the use of a statistical test the decision was made for: H0</td>
<td>Correct decision</td>
<td>Type II error</td>
</tr>
<tr class="even">
<td>By the use of a statistical test the decision was made for: H1</td>
<td>Type I error</td>
<td>Correct decision</td>
</tr>
</tbody>
</table>
<p>Nevertheless, both situations are annoying, so that is why statistical tests usually try to avoid both types of errors. But they can do so only in so far as they adapt their strictness. If they are too strict, they will not reject the null hypothesis to easily, leading to type 2 errors. If they are not strict enough, do you wanna risk type 1 errors. So it is always a balancing act between both error possibilities. The <strong>power</strong> of the statistical test is its capability to avoid type two errors without risking type one error. This capability depends on the amount of information that can be put into the test itself. That means, if we have not very much information not very much evidence, then type two errors are more likely. In general, this also not very desirable, because more powerful tests enable us to differentiate more clearly between random effects and actual patterns in the data.</p>
</section>
<section id="parametric-vs.-nonparametric" class="level2">
<h2 class="anchored" data-anchor-id="parametric-vs.-nonparametric">Parametric vs.&nbsp;Nonparametric</h2>
<p>The question, what nonparametric tests mean, and what distinguish them from parametric tests, is strongly connected to what we have described just above. If we have very little information, because from the data themselves or from general knowledge they can’t be put so much into the equation, then we probably will have tested and not very powerful. On the other hand, this tests might be applicable in situations, we are more powerful tests are not valid, and cannot be used. On the other hand, if we can introduce more information into our test, we have more grounds to differentiate between random effects and actual patterns. This precisely is the difference between parametric and nonparametric tests.</p>
<p><strong>Parametric</strong> tests, we make certain assumptions about the distributions of the values in the population. Quite often, we assume that the values follow the so-called normal distribution. But there are also other possibilities: for example we could have a independence test that require the variance of the data to be equal. We will learn about one of these tests later, and but alternatives we do have in this situation. Quite often, parametric tests also, resulting from their prerequisites, can applied only to metric variables.</p>
<p><strong>Nonparametric</strong> tests on the other hand do not make any of these assumptions. They do not care, what distribution the data might have in the population. Also, most tests for nominal or even ordinal variables are nonparametric. Another benefit is that quite often they are applicable for rather a small sample sizes. But for this flexibility, of course, your pay a price: this tests are not as powerful as their parametric counterparts. Nevertheless, for the dirty and sparse data that archaeology usually has to deal with, we can declared that this kind of tests exist.</p>
</section>
<section id="chi2-test" class="level2">
<h2 class="anchored" data-anchor-id="chi2-test"><span class="math inline">\(\chi^2\)</span> test</h2>
<p>The first statistical test, that we will cover here, is probably one of the most nonparametric tests there is. The Chi-Square test requires only two or more sets of nominal variables, and will try to test whether or not the court occurrence of values is related to each other or not.</p>
<p>This probably doesn’t sound so universal, but in archaeological reality you can cover already quite wide range of possible questions with this. And also, you can base your interpretations much more secure, if you have the ability to differentiate between actual patterns and random results from sampling processes. Such questions might be:</p>
<p><strong>Do settlements tend to be situated on rather good soil or is the distribution random?</strong></p>
<p>If we can differentiate between situations, where to settlement behaviour is just independent from disorder quality, and such situations, where decide quality or a specific side quality makes a difference for the settlement behaviour, we can learn a lot about settlement behaviour in general and it economical dependencies specifically.</p>
<p><strong>Do older individuals have more shoe-last celt as grave goods than younger?</strong></p>
<p>If we assume, and archaeology did so, that shoe-last celt (Schuhleistenkeil) are a sign of social rank in neolithic Linear Band Ceramic groups, then their distribution among the individuals of different age classes can you give us an indication about the construction and reproduction of status and role in society. If, for example these items are evenly distributed among older and younger individuals, can we have an indication that it is not activities during lifetime that define the social rank of a person, but this rank can be inherited. Or the other way round, if these objects are concentrated in order age classes, we have an indication that only with a long life you get the allowance to have one of these objects as burial item. [One problem here: Of course, this is a vicious circle, because the fact that these objects occur in older age classes primarily make them suspicious for being a social marker of rank in the first place.]</p>
<p>All these questions and the related categories are probably not the first thing, and that comes to your mind, when you think about statistical tests. Here, we talk about nominal variables. And this is especially the value of the Chi-Squared test for archaeology: Most of our variables and of our interesting questions are nominal scaled. Let’s have a look how we can perform this test.</p>
<section id="facts-sheet" class="level3">
<h3 class="anchored" data-anchor-id="facts-sheet">Facts sheet</h3>
<section id="chi2-test-for-independence-of-two-distributions" class="level4">
<h4 class="anchored" data-anchor-id="chi2-test-for-independence-of-two-distributions"><span class="math inline">\(\chi^2\)</span> Test for independence of two distributions</h4>
<p><strong>Requirements</strong>: at least 1 nominal scaled variable (one sample case) and 1 nominal scaled grouping variable (two sample case)</p>
<p><strong>Procedure with one sample</strong>: observed values are compared with expected values given a certain distribution, no expected value should be &lt; 5; n should be &gt; 50</p>
<p><strong>Procedure with two samples</strong>: observed values of both distributions are compared with expected values if the samples would be even distributed, no expected value should be &lt; 5; n should be &gt; 50</p>
<p><strong>If sample size is too small</strong>: Fishers Exact Test</p>
<p><strong>Test statistics</strong>: <span class="math inline">\(\chi^2\)</span></p>
<p>Significance depend on degree of freedom (df)</p>
</section>
<section id="what-do-these-facts-mean" class="level4">
<h4 class="anchored" data-anchor-id="what-do-these-facts-mean">What do these facts mean</h4>
<p>Most of this will explain itself when we come to the practical examples. The test itself requires one nominal scaled variable, that means the counts of objects within at least more than one category. So actually not the count number, but the categorisation is the original variable. The nominal scaled grouping variable describes simply the fact that we can differentiate to samples, if we would like to compare to samples. We have to be able to distinguish between apples and oranges. In both cases, we compare the observed values of our dataset with some expected values, that will result from certain assumptions or expectations about how the distribution of the values should be. Also this will be more clearly understandable with the practical example. But in the one sample as well as in the two sample version of the test, there is a requirement of having no expected value (the number of objects of a certain category that you would expect given your assumptions) should be smaller than five, and the total number of cases should be at least 50. Please note, that if this pre-requisites cannot be fulfilled, you can use the so-called Fishers Exact Test instead. Its interpretation is very similar to the one for the Chi-Square test statistic. The test itself is called after the Chi-Square distribution that it uses as test statistic. In statistical tests, often certain theoretical distributions are used as shortcuts to approximates other, more complicated distributions to decide, whether or not the values might come from random processes. The last thing we have to explain to the concept of degrees of freedom.</p>
</section>
</section>
<section id="excursus-degree-of-freedom" class="level3">
<h3 class="anchored" data-anchor-id="excursus-degree-of-freedom">Excursus degree of freedom</h3>
<p>Very general, degree of freedom in statistics means a number of values in a calculation or equation that can vary freely. It is the amount of choices that you have before everything is determined. Let’s assume the following numbers of burials, divided into different classes:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th>male</th>
<th>female</th>
<th>total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>cremation</td>
<td></td>
<td></td>
<td>201</td>
</tr>
<tr class="even">
<td>inhumation</td>
<td></td>
<td></td>
<td>197</td>
</tr>
<tr class="odd">
<td>total</td>
<td>216</td>
<td>182</td>
<td>398</td>
</tr>
</tbody>
</table>
<p>We have the total sums in the margins, we have in total 216 male burials, and 182 female burials. Also, we know already that we have 201 cremation burials and 197 inhumations. But the distribution within the table is not yet determined. We don’t know, how does different values are distributed among the classes. But if we have information about just one cell:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th>male</th>
<th>female</th>
<th>total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>cremation</td>
<td>123</td>
<td></td>
<td>201</td>
</tr>
<tr class="even">
<td>inhumation</td>
<td></td>
<td></td>
<td>197</td>
</tr>
<tr class="odd">
<td>total</td>
<td>216</td>
<td>182</td>
<td>398</td>
</tr>
</tbody>
</table>
<p>Now everything is determined. We can calculate the number of male inhumations, we can also calculate the number of female creation cremations, And then also the number of female inhumations. With just one value set (and it doesn’t matter which value it is actually) the whole table is determined.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th>male</th>
<th>female</th>
<th>total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>cremation</td>
<td>123</td>
<td>78</td>
<td>201</td>
</tr>
<tr class="even">
<td>inhumation</td>
<td>93</td>
<td>104</td>
<td>197</td>
</tr>
<tr class="odd">
<td>total</td>
<td>216</td>
<td>182</td>
<td>398</td>
</tr>
</tbody>
</table>
<p>This means, that this table structure has a degree of freedom of one.</p>
<p><strong>df=1</strong>: if one value is chosen all other can be calculated with the help of the margins</p>
<p>In general, there is a very simple formula to calculate the degrees of freedom of such tables:</p>
<p>(number of columns – 1)*(number of rows – 1)</p>
<p>So we have to substract from the number of column 1, and multiplied it by the number of rows -1. You can calculate the example above with this formula, or check the sample below with the same formula and have already an estimation about how many degrees of freedom this will have.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th>male</th>
<th>female</th>
<th>uncertain</th>
<th>total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>cremation</td>
<td></td>
<td></td>
<td></td>
<td>201</td>
</tr>
<tr class="even">
<td>inhumation</td>
<td></td>
<td></td>
<td></td>
<td>197</td>
</tr>
<tr class="odd">
<td>total</td>
<td>196</td>
<td>179</td>
<td>23</td>
<td>398</td>
</tr>
</tbody>
</table>
<p>No we have three columns, and still two rows. According to our formula, we should have a degree of freedom of two. Let’s try that out. If we introduce one value, there is still possibility to vary other values freely. For example, if we fixed a number of female cremations, we still don’t know or can’t calculate all the other values.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th>male</th>
<th>female</th>
<th>uncertain</th>
<th>total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>cremation</td>
<td></td>
<td>78</td>
<td></td>
<td>201</td>
</tr>
<tr class="even">
<td>inhumation</td>
<td></td>
<td></td>
<td></td>
<td>197</td>
</tr>
<tr class="odd">
<td>total</td>
<td>196</td>
<td>179</td>
<td>23</td>
<td>398</td>
</tr>
</tbody>
</table>
<p>Only if we add another value, for example the number of male cremations, we can calculate all the other values.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th>male</th>
<th>female</th>
<th>uncertain</th>
<th>total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>cremation</td>
<td>113</td>
<td>78</td>
<td></td>
<td>201</td>
</tr>
<tr class="even">
<td>inhumation</td>
<td></td>
<td></td>
<td></td>
<td>197</td>
</tr>
<tr class="odd">
<td>total</td>
<td>196</td>
<td>179</td>
<td>23</td>
<td>398</td>
</tr>
</tbody>
</table>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th>male</th>
<th>female</th>
<th>uncertain</th>
<th>total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>cremation</td>
<td>113</td>
<td>78</td>
<td>10</td>
<td>201</td>
</tr>
<tr class="even">
<td>inhumation</td>
<td>83</td>
<td>101</td>
<td>13</td>
<td>197</td>
</tr>
<tr class="odd">
<td>total</td>
<td>196</td>
<td>179</td>
<td>23</td>
<td>398</td>
</tr>
</tbody>
</table>
<p>As expected from our formula, we have a degree of freedom of two.</p>
<p><strong>df=2</strong>: if two values are chosen all other can be calculated with the help of the margins</p>
<p>(number of columns – 1)*(number of rows – 1)</p>
<p>Using again the formula, I’ll leave the last example for you to figure out yourself.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th>male</th>
<th>female</th>
<th>uncertain</th>
<th>total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>cremation</td>
<td></td>
<td></td>
<td></td>
<td>201</td>
</tr>
<tr class="even">
<td>inhumation</td>
<td></td>
<td></td>
<td></td>
<td>197</td>
</tr>
<tr class="odd">
<td>other</td>
<td></td>
<td></td>
<td></td>
<td>30</td>
</tr>
<tr class="even">
<td>total</td>
<td>201</td>
<td>187</td>
<td>40</td>
<td>428</td>
</tr>
</tbody>
</table>
</section>
<section id="chi2-test-for-one-sample-example-after-shennan" class="level3">
<h3 class="anchored" data-anchor-id="chi2-test-for-one-sample-example-after-shennan"><span class="math inline">\(\chi^2\)</span> Test for one sample (example after Shennan)</h3>
<p>For demonstration using example from the Stephen Shennans book on quantifying archaeology: the number of Neolithic settlements on different soil types in eastern France</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Soil type</th>
<th>Number of settlements</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Rendzina</td>
<td>26</td>
</tr>
<tr class="even">
<td>Alluvial</td>
<td>9</td>
</tr>
<tr class="odd">
<td>Brown earth</td>
<td>18</td>
</tr>
<tr class="even">
<td>total</td>
<td>53</td>
</tr>
</tbody>
</table>
<p>The question that should be answered here is whether or not there is a certain preference for specific soil types. From the data themselves it seems quite obvious, that Rendzina is very much preferred for settlements. So we will not need to statistical methods to check out, which of the sort of type is this preferred, but rather, if this high number of settlements could also result from just random effects. Or to be more concrete, how likely such a random configuration might be, and if it is likely to falsely exclude the possibility of random effects with more than our standard 5% probability for statistical significance.</p>
<p>This is actually a one sample test, because we have only one sample: the amount of settlements on the different soil types. It is probably easier to understand, that this is one variable, if you imagine it is a list of settlements, where we have the values “Rendzina”, “Rendzina”, “Brown earth”, “Alluvial”, and so on. With this it becomes clear that we have a variable that is nominal scaled.</p>
<p>We will calculate two versions of this test here: at first a naive version, in which we assume, that the soil types are evenly distributed over the landscape, with the same area ratio. In the second version, we will add information about the actual distribution of the soil types in the landscape to our equation, and with that we will alter the values that we will expect for its distribution.</p>
<section id="version-1-even-distributed" class="level4">
<h4 class="anchored" data-anchor-id="version-1-even-distributed">Version 1: even distributed</h4>
<p>In this version, we assume that every soil type has the same proportion area in the landscape. If we now randomly distribute our settlements over the landscape, we would expect that each soil type has the same same probability of settlement. Consequently, we would expect that the number of settlements for each side type is the same. In total, we have 53 settlements. If we would evenly distribute these settlements over our three soil types, we would end up with the expection of 17.6667 settlements per soil type.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Soil type</th>
<th>Number of settlements</th>
<th>Proportion of soil type</th>
<th>expected number of settlements</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Rendzina</td>
<td>26</td>
<td>1/3</td>
<td>17.6667</td>
</tr>
<tr class="even">
<td>Alluvial</td>
<td>9</td>
<td>1/3</td>
<td>17.6667</td>
</tr>
<tr class="odd">
<td>Brown earth</td>
<td>18</td>
<td>1/3</td>
<td>17.6667</td>
</tr>
<tr class="even">
<td>total</td>
<td>53</td>
<td>1</td>
<td>53</td>
</tr>
</tbody>
</table>
<p>Now we can formulate a hypothesis: We are interested, if the settlements are not evenly distributed. Therefore, we need to disprove or make unlikely an even distribution. Soour hypothesis look like that:</p>
<p><span class="math inline">\(H_0\)</span>: The settlements are evenly distributed on all soil types.</p>
<p><span class="math inline">\(H_1\)</span>: The settlements are <strong>not</strong> evenly distributed on all soil types.</p>
<p>Of course, from the data we already see, that they are not distributed like our expectation. But of course, there is random chance that a certain soil type gets a higher number of settlements then another. This would also be true if we would use a dice to distribute the number of settlements. We are only interested in the situation, when this rolling a dice scenario is very unlikely, and a pattern behind this distribution cannot be ignored. For that, we have to measure how far the actual data are from our expectation (you could call that measure of surprise), and how likely such a distance from our expectation would be given the possible random nature of the distribution. For the later part, we will use pre-calculated tables, or the statistical program R. But the first part we can calculate ourselves.</p>
<p>Please don’t be afraid: here come to formula! But we will gently introduce and explain this formula to you.</p>
<p>Formula for <span class="math inline">\(\chi^2\)</span>:</p>
<p><span class="math inline">\(\chi^2=\sum_{i=1}^n \frac{(O_i - E_i)^2}{E_i}\)</span></p>
<p><span class="math inline">\(O_i\)</span>: number of <strong>observed</strong> cases</p>
<p><span class="math inline">\(E_i\)</span>: number of <strong>expected</strong> cases</p>
<p><span class="math inline">\(\chi^2\)</span>: symbol for the test statistic chi-squared</p>
<p>The number of observed cases the present our actual data. This is the data that we observed. Consequently, the number of expected cases is represented by our column “expected number of settlements”. In this formula, from our exact cases our expectations are substracted to calculate the difference. Because we don’t care if I were observed cases are bigger or smaller than our expectations, because we are only interested in the difference, we square them to get rid of the sign. Then we have to take care, get our measure of surprise is independent from the number of cases. This is because the difference of 10 will probably surprise us, if the total number of cases is 20, but in the situation, where the total number is 5000, this difference of 10 probably is totally irrelevant. That is why we divide by the number of expected cases again, to normalise for the expected magnitude of our data. That must be repeated for every cell of the table. Once this is done, we can sum up all over individual measures of surprise to get the total surprise for the table, or more formally does Chi-Squared value for the table.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th>Soil type</th>
<th>Number of observed cases</th>
<th>Number of expected cases</th>
<th><span class="math inline">\(O_i - E_i\)</span></th>
<th><span class="math inline">\((O_i - E_i)^2\)</span></th>
<th><span class="math inline">\(\frac{(O_i - E_i)^2}{E_i}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Rendzina</td>
<td>26</td>
<td>17.6667</td>
<td>8.3333</td>
<td>69,4444</td>
<td>3.9308</td>
</tr>
<tr class="even">
<td>Alluvial</td>
<td>9</td>
<td>17.6667</td>
<td>-8.6667</td>
<td>75,1117</td>
<td>4.2516</td>
</tr>
<tr class="odd">
<td>Brown earth</td>
<td>18</td>
<td>17.6667</td>
<td>0.3333</td>
<td>0.1111</td>
<td>0.0063</td>
</tr>
<tr class="even">
<td>total</td>
<td>53</td>
<td>53</td>
<td></td>
<td></td>
<td><strong>8.18868</strong></td>
</tr>
</tbody>
</table>
<p>In this specific case, and starting from our expectations, we are rather surprised about the value of Rendzina, Because it is much higher than our expectations and even more surprised about the value of Alluvial, but this time, because it’s much lower than our expectation. We seem not to be surprised at all by the value of brown earth, because the difference to our expectation is below one. The total measure of surprise (or Chi-Square value) is 8.18868. Currently, we do not know how to interpret that, we have no framework for it. What approach could be now to calculate several random settings and see, how because the price can be given random distribution. This easily can be done today using a computer. Before a computer was available to everyone, this was very hard, and so a lot of precalculated tables were available. One of those food precalculated tables can be found in the book of Stephen Shennan. These tables are structured according to the level of significance (in our case 0.05) and the degrees of freedom (in our case 2, because we have one column for the observed and one column for the expected cases). With degree of freedom and level of significance we will find the threshold value. If our calculated threshold value is above this threshold, we have a significant result. This means, that there is a chance below 5% to go wrong to reject the null hypothesis, based on our data. In our case, the threshold is 5.99145. The value we have calculated is much higher, therefore we have a significant result. There’s quite enough evidence to assume, that there is a preference for specific soil type visible in this settlement behaviour.</p>
</section>
<section id="version-2-even-distributed-with-consideration-of-the-proportion-of-the-soil-types-on-the-total-area" class="level4">
<h4 class="anchored" data-anchor-id="version-2-even-distributed-with-consideration-of-the-proportion-of-the-soil-types-on-the-total-area">Version 2: even distributed with consideration of the proportion of the soil types on the total area</h4>
<p>In the second version, we know how much area the difference or types take up in the landscape. This does not alter our data, but our expectations. If we know, how much percentage of the landscape is constituted off the individual soils, we also would exceed proportional amount of settlements to be situated on these soils. Now in this example, the distribution it’s not so far away from the even distribution, but slightly.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Soil type</th>
<th>Number of settlements</th>
<th>Proportion of soil type</th>
<th>expected number of settlements</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Rendzina</td>
<td>26</td>
<td>32%</td>
<td>16.69</td>
</tr>
<tr class="even">
<td>Alluvial</td>
<td>9</td>
<td>25%</td>
<td>13.25</td>
</tr>
<tr class="odd">
<td>Brown earth</td>
<td>18</td>
<td>34%</td>
<td>22.79</td>
</tr>
<tr class="even">
<td>total</td>
<td>53</td>
<td>1</td>
<td>53</td>
</tr>
</tbody>
</table>
<p>For example, Rendzina makes 32% of the size of the landscape, resulting in an expectation of 16.69 settlements on this soil (multiplying the total number of 53 settlements by this percentage). From here on the onward, everything is the same like in the example before. We have to compare our expectation with our data, measure our surprise, and compare that to the possible surprise from random effects.</p>
<p><span class="math inline">\(\chi^2=\sum_{i=1}^n \frac{(O_i - E_i)^2}{E_i}\)</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th>Soil type</th>
<th>Number of observed cases</th>
<th>Number of expected cases</th>
<th><span class="math inline">\(O_i - E_i\)</span></th>
<th><span class="math inline">\((O_i - E_i)^2\)</span></th>
<th><span class="math inline">\(\frac{(O_i - E_i)^2}{E_i}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Rendzina</td>
<td>26</td>
<td>16.69</td>
<td>9.04</td>
<td>81.7216</td>
<td>4.8185</td>
</tr>
<tr class="even">
<td>Alluvial</td>
<td>9</td>
<td>13.25</td>
<td>-4.25</td>
<td>18.0625</td>
<td>1.1363</td>
</tr>
<tr class="odd">
<td>Brown earth</td>
<td>18</td>
<td>22.79</td>
<td>-4.79</td>
<td>22.9441</td>
<td>1.007</td>
</tr>
<tr class="even">
<td>total</td>
<td>53</td>
<td>53</td>
<td></td>
<td></td>
<td><strong>7.1885</strong></td>
</tr>
</tbody>
</table>
<p>The resulting number is slightly lower, but still beyond the threshold of 5.99145. So even considering the different proportions of the soils in the landscape, the result is still significant, and we have to interpret the preference pattern for specific soils</p>
</section>
<section id="chi2-test-in-r" class="level4">
<h4 class="anchored" data-anchor-id="chi2-test-in-r"><span class="math inline">\(\chi^2\)</span> test in R</h4>
<p>Let’s recreate the example in our. At first, we have to create a vector with our data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>settlements <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">26</span>,<span class="dv">9</span>,<span class="dv">18</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(settlements) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Rendzina"</span>,<span class="st">"Alluvial"</span>,<span class="st">"brown earth"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>settlements</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Rendzina    Alluvial brown earth 
         26           9          18 </code></pre>
</div>
</div>
<p>If we don’t have any specific expectations about the distribution, we directly can input the vector into the commands. It will default to an even distribution, and will compare it to this.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(settlements)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test for given probabilities

data:  settlements
X-squared = 8.1887, df = 2, p-value = 0.01667</code></pre>
</div>
</div>
<p>Given our knowledge and our own endeavours, we can easily interpret the output of the command now. The <code>X-squared</code> is that Chi-Squared value that we also calculated. Because it’s a one sample test, R also calculate the degrees of freedom correctly. The last return value is the p-value. Instead of just giving us significant or not significant, R calculates the error probability for rejecting the null hypothesis. Since this p-value is below 0.05, we can reject the null hypothesis and collet a significant result.</p>
<p>We can introduce our expected proportions using the parameter <code>p</code>. Here, we give the percentages of the sort of types on the landscape as fractions, so that they sum up to 1</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(settlements,<span class="at">p=</span><span class="fu">c</span>(<span class="fl">0.32</span>,<span class="fl">0.25</span>,<span class="fl">0.43</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test for given probabilities

data:  settlements
X-squared = 7.1885, df = 2, p-value = 0.02748</code></pre>
</div>
</div>
<p>You can read the result in the same way like the one above. You will realise that the Chi-Squared value is lower, and that the p-value is higher, meaning there is a higher chance of making an error rejected the null hypothesis.</p>
<p>Now that you have seen, how are you can calculate to one sample version by hand, and using R, we will turn our attention to the two sample version of the Chi squared test.</p>
</section>
</section>
<section id="two-sample-case-test-for-independence" class="level3">
<h3 class="anchored" data-anchor-id="two-sample-case-test-for-independence">Two sample case (Test for independence)</h3>
<p>In the examples before, we have compared one sample to a theoretical distribution, also enriched with some external knowledge. There, we have analysed how well our sample fits to some assumptions about the population. In the two sample case, we compare if the distribution of the values is independent between two populations. The data from this task may also come from the same data collection. Using a grouping variable, we divide this sample into two possible independent populations and test, if this independence is actually true.</p>
<p>As an example, I will use the distribution of amber in the sites of the Unetice culture. Here, we compare graves and settlements in relation to the presence of amber. We would like to find out, if the deposition conditions, and the causing traditions and behaviour is so different that we have to assume that different Processes must have been involved at the different site categories.</p>
<p>For this, we construct 2 x 2 table. Quite often, you will encounter situations, where this 2 x 2 set up might be applicable to your data. For example, every time you may like to find out if the presence of what artefact is connected to the presence of another artefact, this restructuring of the data might be useful.</p>
<p><em>(example after Hinz, beautified)</em></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type of site</th>
<th>amber</th>
<th></th>
<th>total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>+</td>
<td>-</td>
<td></td>
</tr>
<tr class="even">
<td>settlement</td>
<td>6</td>
<td>18</td>
<td>24</td>
</tr>
<tr class="odd">
<td>grave</td>
<td>132</td>
<td>44</td>
<td>176</td>
</tr>
<tr class="even">
<td>total</td>
<td>138</td>
<td>62</td>
<td>200</td>
</tr>
</tbody>
</table>
<p>So, our scientific question is if amber is primary a grave good in this society, or if it is distributed evenly across the different site categories. Like in most other situations, also here we aim for a certainty (level of significance) of 0.05. So, we will reject or not hypothesis only if we are 95% sure that it is wrong. Having 2 x 2 table, we have two rolls and two columns, which results in a degree of freedom of 1 (remember the formula to calculate degrees of freedom from above).</p>
<p>Our first task is to establish our expectation. We have to calculate the expected number of occurrence in the different side categories, given the assumption, that the distribution is independent from the site categories. In such a case, the number of sites with amber in settlements and in burials would only depend on The total number of sites with ember, and the ratio between sides of the type of settlement and sides of the type grave. Conversely, this is also true for the number of sites without amber.</p>
<p>So in total, we have 24 sites of the category settlement. If it would not matter, if it is a settlement or a burial, then the ratio between settlements with and without amber would be the same as the total ratio of sites with and without amber. The total ratio of amber present versus amber not present is 138 to 62. So we have more sites with amber in our sample then without. Of over 200 sites in total, 24 or settlements. That means, that 24÷200, or 12% of the sites are settlements. Also, 138÷200, or 69% of the sites have amber. That means, that of our 12% settlement sites (that is 24), 69% (that is 16.56) should be settlement sites with amber, given that amber is distributed independently from site categories.</p>
<p>This means, that we can use the margins of our table to calculate the expectation values. Using Cross-multiplication, we can multiply the margins and divide the result by the total number to get the number of sites that we would expect given independence. We need to repeat this procedure for every cell in our table, to get the expectation values for every individual possibility.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type of site</th>
<th>amber</th>
<th></th>
<th>total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>+</td>
<td>-</td>
<td></td>
</tr>
<tr class="even">
<td>settlement</td>
<td>24/200*138 = 16.56</td>
<td>24/200*62=7.44</td>
<td>24</td>
</tr>
<tr class="odd">
<td>grave</td>
<td>138/200*176=121.44</td>
<td>62/200*176=54,56</td>
<td>176</td>
</tr>
<tr class="even">
<td>total</td>
<td>138</td>
<td>62</td>
<td>200</td>
</tr>
</tbody>
</table>
<p>From here onwards, the procedure is essentially the same like in the one sample case. For every cell, Using the Chi-Square formula, we calculate our measure of surprise, substracting the expectation from the observation, square result and divide by expectatio. Then we have to sum this up for the total table.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type of site</th>
<th>amber</th>
<th></th>
<th>total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>+</td>
<td>-</td>
<td></td>
</tr>
<tr class="even">
<td>settlement</td>
<td>O=6 vs.&nbsp;E=16.56</td>
<td>O=18 vs.&nbsp;E=7.44</td>
<td>24</td>
</tr>
<tr class="odd">
<td>grave</td>
<td>O=132 vs.&nbsp;E=121.44</td>
<td>O=44 vs.&nbsp;E=54.56</td>
<td>176</td>
</tr>
<tr class="even">
<td>total</td>
<td>138</td>
<td>62</td>
<td>200</td>
</tr>
</tbody>
</table>
<p><span class="math inline">\(\chi^2=\sum_{i=1}^n \frac{(O_i - E_i)^2}{E_i}\)</span></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type of site</th>
<th>amber</th>
<th></th>
<th>total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>+</td>
<td>-</td>
<td></td>
</tr>
<tr class="even">
<td>settlement</td>
<td>(6-16.56)^2/16.56=6.73</td>
<td>(18-7.44)^2/7.44=14.99</td>
<td>24</td>
</tr>
<tr class="odd">
<td>grave</td>
<td>(132-121.44)^2/121.44=0.92</td>
<td>(44-54.56)^2/54.56=2.04</td>
<td>176</td>
</tr>
<tr class="even">
<td>total</td>
<td>138</td>
<td>62</td>
<td>200</td>
</tr>
</tbody>
</table>
<p>The total <span class="math inline">\(\chi^2\)</span> is 24.68. Looking up in the table, we will find for a significant level of 0.05 and a degree of freedom of Df=1 the threshold of 3.84146. This means, we are much more surprised by the distribution of our data then our threshold value for possible random processes indicates. Therefore, the result is significant, and we can reject the null hypothesis and state, given our sample, that amber seem to be primarily a grave goods in the Unetice culture.</p>
<section id="chi2-test-for-indipendence-in-r" class="level4">
<h4 class="anchored" data-anchor-id="chi2-test-for-indipendence-in-r"><span class="math inline">\(\chi^2\)</span> test for indipendence in R</h4>
<p>To calculate the same table in R, at first we have to enter all our data. Since now we have a 2 x 2 table, we have to produce a matrix representing all data. The calculation of course only needs the numbers, but for convenience we name our matrix with row and column names. Please note that we are using the <code>matrix()</code> command. In this command, as first parameter we give our values at first for the first column, then for the second column and so on in a vector. Then, we specify that we want a matrix with two columns. With that, our values are distributed between these two columns, and the result is a table representing the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>amber<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">132</span>,<span class="dv">18</span>,<span class="dv">44</span>),<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(amber)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"with amber"</span>,<span class="st">"without amber"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(amber)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"settlement"</span>,<span class="st">"grave"</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>amber</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           with amber without amber
settlement          6            18
grave             132            44</code></pre>
</div>
</div>
<p>Now we can run our Chi-Squared test light before, entering the variable into the command for the test itself.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(amber)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with Yates' continuity correction

data:  amber
X-squared = 22.402, df = 1, p-value = 2.211e-06</code></pre>
</div>
</div>
<p>If you have a closer look to the result, you will be able to see that R is given us the correct degree of freedom, and the P-value indicating a significant result, because it is below 0.05. But you also will see that the total Chi-Square value is only 22.402, and not 24.684, as we have calculated ‘by hand’! Did we, or R, made a mistake here?</p>
<p>No, actually not. On an even closer inspection, you will see, that the headline of the test result states that it is ‘Pearson’s Chi-squared test with Yates’ continuity correction’. By default, our is introducing a correction for small sample sizes, that is known as ‘Yates’ continuity correction’. Instead of directly squaring the observed minus the expectation values, it’s abstracts 0.5 from the absolute difference of both. The formula for this is <span class="math inline">\((|O-E|-0,5)²/E\)</span>. Substracting the small number does make a difference in case of a small sample size, because in this situation also the results from substracting the expectation from the observed will result in a small number. But if the result is large, because the sample size is also a large, 0.5 will not change so much in the end. Of course, we can also calculate the raw Chi-Square result. In this case we have to specify that we do not want the correction to take place.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(amber,<span class="at">correct=</span>F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  amber
X-squared = 24.684, df = 1, p-value = 6.753e-07</code></pre>
</div>
</div>
<p>Now the result is exactly like we have calculated it on our own. In case of small sample sizes, the correction already helps a bit to make the result robust. But in such a situation, especially when the number of cases is very small, it might be a good idea to use the Fishers Exact test instead of the Chi-Squared test. If you’re interested, you may find a description of this test procedure <a href="https://en.wikipedia.org/wiki/Fisher%27s_exact_test">here</a>, and its implementation R <a href="https://statsandr.com/blog/fisher-s-exact-test-in-r-independence-test-for-a-small-sample/">here</a>.</p>
</section>
<section id="chi2-excercise" class="level4">
<h4 class="anchored" data-anchor-id="chi2-excercise"><span class="math inline">\(\chi^2\)</span> excercise</h4>
<p>You can try out your skills in Chi-Square testing yourself using the following exercise:</p>
<div class="exercise">
<p>Given all the animal bones from the Neolithic side of welcome Wolkenwehe (Mischka et al.&nbsp;2005). We have here to Neolithic layers, one from the middle and one from the late Neolithic. The minimum number of individuals of different animals are divided into wild and domestic animals. Please test, if the ratio between wild and domestic animals is independent from the layer, and with that independent from the period of use of the site.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>layer</th>
<th>Domestic animal</th>
<th>Wild animal</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>202 (late neolithic)</td>
<td>159</td>
<td>32</td>
</tr>
<tr class="even">
<td>203 (middle neolithic)</td>
<td>84</td>
<td>54</td>
</tr>
</tbody>
</table>
</div>
<details>
<summary>
Solution
</summary>
<p>At first, we have to construct our matrix for the data we have.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>ww<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">159</span>,<span class="dv">84</span>,<span class="dv">32</span>,<span class="dv">54</span>),<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ww)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"domestic"</span>,<span class="st">"wild"</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(ww)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"late_neo"</span>,<span class="st">"mid_neo"</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>ww</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         domestic wild
late_neo      159   32
mid_neo        84   54</code></pre>
</div>
</div>
<p>Then, we performed a Chi-Squared test.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(ww)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with Yates' continuity correction

data:  ww
X-squared = 19.634, df = 1, p-value = 9.376e-06</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(ww, <span class="at">correct =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  ww
X-squared = 20.777, df = 1, p-value = 5.159e-06</code></pre>
</div>
</div>
<p>You can see, that now, since we have more cases, the yates correction does not change the results in the same intensity like another example. But in both situations, we have a significant result: the differences between the different layers are statistical significant.</p>
</details>
</section>
</section>
</section>
<section id="kolmogorovsmirnov-test" class="level2">
<h2 class="anchored" data-anchor-id="kolmogorovsmirnov-test">Kolmogorov–Smirnov test</h2>
<p>Our second nonparametric test is the Kolmogorov–Smirnov test, or short KS test. This test can be used in situations, where are you having ordinal scales or better variable. Such a variable has more informational value, and therefore the test can also perform with a higher power. That means, that this test is more capable of avoiding type 2 errors. The downside is that it is only applicable if we have this kind of data present. Also, Kolmogorov–Smirnov test can be used as an goodness of fit test in the one sample case, and as a test for independence in the two sample case.</p>
<section id="facts-sheet-ks-test" class="level3">
<h3 class="anchored" data-anchor-id="facts-sheet-ks-test">Facts sheet KS-Test</h3>
<p><strong>requirements</strong>: at least one ordinal scaled Variable (one sample case) and 1 nominal scaled grouping variable (two sample case)</p>
<p><strong>Procedure one sample case</strong>: the cumulative procentual frequency of the sample is compared with a standard distribution (often normal distribution)</p>
<p><strong>Procedure two sample case</strong>: the cumulative procentual frequencies of the samples is compared</p>
<section id="what-do-these-facts-mean-1" class="level4">
<h4 class="anchored" data-anchor-id="what-do-these-facts-mean-1">What do these facts mean</h4>
<p>We test against a at least ordinal scaled variable. Please note, that the KS-Test is also very useful in situations where you have a metric data. When we have to distinguish between two samples, we need again a at least nominal scaled grouping variable.</p>
<p>In the test procedure, we order our values according to the ordinal scale variable, and then we calculate the procentual frequency for every cell in our table. Finally, we sum these frequencies up starting from the top to the bottom. This gives us the cumulative procentual frequency. Now we calculate again the difference to our expectation, either against a theoretical distribution, or against the other sample. Then we are looking forward to the maximum difference, and compare this to a threshold, that this time we calculate ourselves given the number of cases that we have in the different samples. If we are more surprised by the difference then a random situation could produce within 95% of the cases, we assume statistical significance. Please follow example to understand precisely what this means.</p>
</section>
</section>
<section id="example-after-shennan" class="level3">
<h3 class="anchored" data-anchor-id="example-after-shennan">Example (after Shennan)</h3>
<p>Here, again we are using an example from the Stephen Shennan book. We are analysing female Bronze Age burials from a graveyard. The individuals buried our listed according to the different age classes. This age classes represent our ordinal variable.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">rich</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">poor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">infans I</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">23</td>
</tr>
<tr class="even">
<td style="text-align: left;">infans II</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">21</td>
</tr>
<tr class="odd">
<td style="text-align: left;">juvenilus</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="even">
<td style="text-align: left;">adultus</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">36</td>
</tr>
<tr class="odd">
<td style="text-align: left;">maturus</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">27</td>
</tr>
<tr class="even">
<td style="text-align: left;">senilis</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sum</td>
<td style="text-align: right;">76</td>
<td style="text-align: right;">136</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Looking at the data, you will realise that there are more individuals in the poorer category that died in younger ages. But also in total, there are more individuals in the category poor. You can have the hypothesis, get people that were equipped more rich when buried also represents richer individuals during lifetime. And you can also have the assumption, that rich individuals had more access to resources, and probably also had the chance to get older. So here, the question might arise, it needs to be answered in a statistical way, if there is a significant difference between the mortality pattern in both categories.</p>
<p>From this data and our assumption, we build up our test configuration. Our hypothesis is that there is the difference between the two mortality patterns. Therefore, another hypothesis is that there is no difference. So we assume, that the distribution of age at death is independent from the number of burial items.</p>
<p><span class="math inline">\(H_0\)</span>: There is no difference between rich and poor graves according to age of death.</p>
<p><span class="math inline">\(H_1\)</span>: There is a difference between rich and poor graves according to age of death.</p>
<p>Since the difference can be that poor died earlier, or later, we have a two-tailed test here. As always, our level of significance is 0.05. We use the age classes as ordinal scaled test variable, and the wealth classes as at least nominal scaled grouping variable. Wealth proceed can be understood as an ordinal scale. But we can always scale down the variable, so we treated just as if it is an nominal scaled one. In the table, the levels are already sorted according to our ordinal scaled variable. If not, of course you can easily do it yourself.</p>
<p><strong>Level of significance</strong>: 0.05</p>
<p><strong>variables</strong>:</p>
<ol type="1">
<li>ordinal scaled age classes</li>
<li>(at least) nominale (ordinale) scaled wealth classes</li>
</ol>
<p>At first, we will calculate the procentual frequency. That is the ratio of the individual classes in respect to the total number. Simply, we divide every cell by the total sum. If you would multiply that by 100, you would get the percentage.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">rich</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">rich_ratio</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">poor</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">poor_ratio</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">infans I</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.0789474</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">0.1691176</td>
</tr>
<tr class="even">
<td style="text-align: left;">infans II</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0.1052632</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">0.1544118</td>
</tr>
<tr class="odd">
<td style="text-align: left;">juvenilus</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">0.1447368</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">0.1838235</td>
</tr>
<tr class="even">
<td style="text-align: left;">adultus</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">0.3815789</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">0.2647059</td>
</tr>
<tr class="odd">
<td style="text-align: left;">maturus</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">0.2500000</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">0.1985294</td>
</tr>
<tr class="even">
<td style="text-align: left;">senilis</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.0394737</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.0294118</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sum</td>
<td style="text-align: right;">76</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">136</td>
<td style="text-align: right;">1.0000000</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>You can see, that while the actual numbers sum up to the total number for each category, the ratios some up to 1. Is the next step, we have to calculate the cumulative frequency. That means, but with sum up the values from top to bottom for each row, including all the values of the categories that are smaller than the actual category. So in the first row, infans I, the cumulative frequency is actually the same value as the original frequency. In the second row, infans II, the cumulative frequency is the value of infans I plus the value of infans II. And so on.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">rich</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">rich_ratio</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">rich_cumsum</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">poor</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">poor_ratio</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">poor_cumsum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">infans I</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.0789474</td>
<td style="text-align: right;">0.0789474</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">0.1691176</td>
<td style="text-align: right;">0.1691176</td>
</tr>
<tr class="even">
<td style="text-align: left;">infans II</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0.1052632</td>
<td style="text-align: right;">0.1842105</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">0.1544118</td>
<td style="text-align: right;">0.3235294</td>
</tr>
<tr class="odd">
<td style="text-align: left;">juvenilus</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">0.1447368</td>
<td style="text-align: right;">0.3289474</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">0.1838235</td>
<td style="text-align: right;">0.5073529</td>
</tr>
<tr class="even">
<td style="text-align: left;">adultus</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">0.3815789</td>
<td style="text-align: right;">0.7105263</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">0.2647059</td>
<td style="text-align: right;">0.7720588</td>
</tr>
<tr class="odd">
<td style="text-align: left;">maturus</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">0.2500000</td>
<td style="text-align: right;">0.9605263</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">0.1985294</td>
<td style="text-align: right;">0.9705882</td>
</tr>
<tr class="even">
<td style="text-align: left;">senilis</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.0394737</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.0294118</td>
<td style="text-align: right;">1.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sum</td>
<td style="text-align: right;">76</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">3.2631579</td>
<td style="text-align: right;">136</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">3.7426471</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Now you can see, that while the sum of the procentual frequency is 1, but after cumulative frequency is the number different from 1. At the same time the last real value in this column is 1 (‘senilis’). And the other values are constantly rising going down our age classes. That means, for example in the role of ‘adultus’ the valley represents all the individuals that died in that age class or younger.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">rich_cumsum</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">poor_cumsum</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">difference</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">infans I</td>
<td style="text-align: right;">0.0789474</td>
<td style="text-align: right;">0.1691176</td>
<td style="text-align: right;">0.0901703</td>
</tr>
<tr class="even">
<td style="text-align: left;">infans II</td>
<td style="text-align: right;">0.1842105</td>
<td style="text-align: right;">0.3235294</td>
<td style="text-align: right;">0.1393189</td>
</tr>
<tr class="odd">
<td style="text-align: left; background-color: lightsalmon !important;">juvenilus</td>
<td style="text-align: right; background-color: lightsalmon !important;">0.3289474</td>
<td style="text-align: right; background-color: lightsalmon !important;">0.5073529</td>
<td style="text-align: right; background-color: lightsalmon !important;">0.1784056</td>
</tr>
<tr class="even">
<td style="text-align: left;">adultus</td>
<td style="text-align: right;">0.7105263</td>
<td style="text-align: right;">0.7720588</td>
<td style="text-align: right;">0.0615325</td>
</tr>
<tr class="odd">
<td style="text-align: left;">maturus</td>
<td style="text-align: right;">0.9605263</td>
<td style="text-align: right;">0.9705882</td>
<td style="text-align: right;">0.0100619</td>
</tr>
<tr class="even">
<td style="text-align: left;">senilis</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Now we have to identify the situation, we are both distributions different the most. For this, we have to substract one cumulative frequency from the other, and make the values absolute removing to sign. Having done this, we can identify those at the age class ‘juvenilus’ the difference is the highest with a value of 0.178. This is our test statistic that we will compare to a calculated threshold.</p>
<p>By comparing the percentages, our degree of surprise within our data is already independent of the number of cases. Thus, we now need to find a threshold value that indicates how large the deviation could be within a sample that is only dependent on the random distribution. At the same time, however, this surprise also depends on the number of cases: if we have fewer cases, larger differences can also arise purely by chance. The law of large numbers applies here, which we will get to know in more detail later: The more cases we consider, the more purely random effects will cancel each other out. Therefore, we need more surprise for a smaller number of cases in order to be convinced that this could not have been caused by a random distribution. At the same time, the required degree of surprise also depends on the significance level that we want to achieve: the more certain we want to be, i.e.&nbsp;the greater our significance level must be, the greater the surprise must be in order to be considered significant.</p>
<p>In the following formula for calculating threshold, both aspects are considered.</p>
<p><span class="math inline">\(threshold = f * \sqrt{\frac{n_1 + n_2}{n_1 * n_2} }\)</span></p>
<p>In the formula, you can see <span class="math inline">\(n_1\)</span> and <span class="math inline">\(n_2\)</span>. These numbers represent the number of cases in the first and the second sample. In the numerator of the fraction, you can see that both sample sizes are added, while in the denominator they are multiplied. This means, that the resulting number will be higher, when the total sample size is smaller, and vice versa. The other factor is <span class="math inline">\(f\)</span>, which is the constant that depends on the level of significance that we would like to achieve.</p>
<p>Factor f:</p>
<ul>
<li>Level of significance 0.05: 1.36</li>
<li>Level of significance 0.01: 1.63</li>
<li>Level of significance 0.001: 1.95</li>
</ul>
<p>So all we have to do is to fill in the numbers from our samples and the value for the level of significance that we would like to achieve. In our case, these are the following numbers:</p>
<p>Total number rich: 76 = <span class="math inline">\(n_1\)</span></p>
<p>Total number poor: 136 = <span class="math inline">\(n_2\)</span></p>
<p>So the calculation for a threshold is unfolding like this:</p>
<p><span class="math inline">\(threshold = 1.36 * \sqrt{\frac{76 + 136}{76 * 136} } = 0.1947738\)</span></p>
<p>No, we can compare that to the value that we have calculated from all sample:</p>
<p>Difference max (D_max): 0.178</p>
<p>You can see, that 0.1947738 &gt; 0.178. This means, that the difference can not be considered to be significant.</p>
<p>But this does not mean, that the distribution is actually equal! Since we have made is dependent on the sample size, it is clear that there are two reasons why a significant result could not have been reached: Either, the resulting difference is really not big enough, so that it could result from a random process. Or I will sample size is just too small, so that we can really differentiate between random and patterned processes.</p>
<p>Here, with archaeological thinking, we can already spot a possible error in our assumption: quite big differences exist in the lowest category, that is ‘infans I’. From our science we know, that burials of children are often not be equipped with very many of your items, independent from the circumstances in life. So here is a possible source of bias, that our calculation cannot reveal, but that we have to identify using our domain knowledge. But also in this situation, statistical tests can help to identify these divergence from our expectation, and make us think about possible reasons for this.</p>
</section>
<section id="ks-test-in-r" class="level3">
<h3 class="anchored" data-anchor-id="ks-test-in-r">KS-Test in R</h3>
<p>Let’s do the same test using R. You probably like to download the data for your own experimentation.</p>
<ul>
<li><a href="data:text/csv;base64,IiI7ImFsdGVyIjsicmVpY2h0dW0iCiIxIjsxOyJyZWljaCIKIjIiOzE7InJlaWNoIgoiMyI7MTsicmVpY2giCiI0IjsxOyJyZWljaCIKIjUiOzE7InJlaWNoIgoiNiI7MTsicmVpY2giCiI3IjsxOyJyZWljaCIKIjgiOzE7InJlaWNoIgoiOSI7MTsicmVpY2giCiIxMCI7MTsicmVpY2giCiIxMSI7MTsicmVpY2giCiIxMiI7MTsicmVpY2giCiIxMyI7MTsicmVpY2giCiIxNCI7MTsicmVpY2giCiIxNSI7MTsicmVpY2giCiIxNiI7MTsicmVpY2giCiIxNyI7MTsicmVpY2giCiIxOCI7MTsicmVpY2giCiIxOSI7MTsicmVpY2giCiIyMCI7MTsicmVpY2giCiIyMSI7MTsicmVpY2giCiIyMiI7MTsicmVpY2giCiIyMyI7MTsicmVpY2giCiIyNCI7MTsiYXJtIgoiMjUiOzE7ImFybSIKIjI2IjsxOyJhcm0iCiIyNyI7MTsiYXJtIgoiMjgiOzE7ImFybSIKIjI5IjsxOyJhcm0iCiIzMCI7MjsicmVpY2giCiIzMSI7MjsicmVpY2giCiIzMiI7MjsicmVpY2giCiIzMyI7MjsicmVpY2giCiIzNCI7MjsicmVpY2giCiIzNSI7MjsicmVpY2giCiIzNiI7MjsicmVpY2giCiIzNyI7MjsicmVpY2giCiIzOCI7MjsicmVpY2giCiIzOSI7MjsicmVpY2giCiI0MCI7MjsicmVpY2giCiI0MSI7MjsicmVpY2giCiI0MiI7MjsicmVpY2giCiI0MyI7MjsicmVpY2giCiI0NCI7MjsicmVpY2giCiI0NSI7MjsicmVpY2giCiI0NiI7MjsicmVpY2giCiI0NyI7MjsicmVpY2giCiI0OCI7MjsicmVpY2giCiI0OSI7MjsicmVpY2giCiI1MCI7MjsicmVpY2giCiI1MSI7MjsiYXJtIgoiNTIiOzI7ImFybSIKIjUzIjsyOyJhcm0iCiI1NCI7MjsiYXJtIgoiNTUiOzI7ImFybSIKIjU2IjsyOyJhcm0iCiI1NyI7MjsiYXJtIgoiNTgiOzI7ImFybSIKIjU5IjszOyJyZWljaCIKIjYwIjszOyJyZWljaCIKIjYxIjszOyJyZWljaCIKIjYyIjszOyJyZWljaCIKIjYzIjszOyJyZWljaCIKIjY0IjszOyJyZWljaCIKIjY1IjszOyJyZWljaCIKIjY2IjszOyJyZWljaCIKIjY3IjszOyJyZWljaCIKIjY4IjszOyJyZWljaCIKIjY5IjszOyJyZWljaCIKIjcwIjszOyJyZWljaCIKIjcxIjszOyJyZWljaCIKIjcyIjszOyJyZWljaCIKIjczIjszOyJyZWljaCIKIjc0IjszOyJyZWljaCIKIjc1IjszOyJyZWljaCIKIjc2IjszOyJyZWljaCIKIjc3IjszOyJyZWljaCIKIjc4IjszOyJyZWljaCIKIjc5IjszOyJyZWljaCIKIjgwIjszOyJyZWljaCIKIjgxIjszOyJyZWljaCIKIjgyIjszOyJyZWljaCIKIjgzIjszOyJyZWljaCIKIjg0IjszOyJhcm0iCiI4NSI7MzsiYXJtIgoiODYiOzM7ImFybSIKIjg3IjszOyJhcm0iCiI4OCI7MzsiYXJtIgoiODkiOzM7ImFybSIKIjkwIjszOyJhcm0iCiI5MSI7MzsiYXJtIgoiOTIiOzM7ImFybSIKIjkzIjszOyJhcm0iCiI5NCI7MzsiYXJtIgoiOTUiOzQ7InJlaWNoIgoiOTYiOzQ7InJlaWNoIgoiOTciOzQ7InJlaWNoIgoiOTgiOzQ7InJlaWNoIgoiOTkiOzQ7InJlaWNoIgoiMTAwIjs0OyJyZWljaCIKIjEwMSI7NDsicmVpY2giCiIxMDIiOzQ7InJlaWNoIgoiMTAzIjs0OyJyZWljaCIKIjEwNCI7NDsicmVpY2giCiIxMDUiOzQ7InJlaWNoIgoiMTA2Ijs0OyJyZWljaCIKIjEwNyI7NDsicmVpY2giCiIxMDgiOzQ7InJlaWNoIgoiMTA5Ijs0OyJyZWljaCIKIjExMCI7NDsicmVpY2giCiIxMTEiOzQ7InJlaWNoIgoiMTEyIjs0OyJyZWljaCIKIjExMyI7NDsicmVpY2giCiIxMTQiOzQ7InJlaWNoIgoiMTE1Ijs0OyJyZWljaCIKIjExNiI7NDsicmVpY2giCiIxMTciOzQ7InJlaWNoIgoiMTE4Ijs0OyJyZWljaCIKIjExOSI7NDsicmVpY2giCiIxMjAiOzQ7InJlaWNoIgoiMTIxIjs0OyJyZWljaCIKIjEyMiI7NDsicmVpY2giCiIxMjMiOzQ7InJlaWNoIgoiMTI0Ijs0OyJyZWljaCIKIjEyNSI7NDsicmVpY2giCiIxMjYiOzQ7InJlaWNoIgoiMTI3Ijs0OyJyZWljaCIKIjEyOCI7NDsicmVpY2giCiIxMjkiOzQ7InJlaWNoIgoiMTMwIjs0OyJyZWljaCIKIjEzMSI7NDsiYXJtIgoiMTMyIjs0OyJhcm0iCiIxMzMiOzQ7ImFybSIKIjEzNCI7NDsiYXJtIgoiMTM1Ijs0OyJhcm0iCiIxMzYiOzQ7ImFybSIKIjEzNyI7NDsiYXJtIgoiMTM4Ijs0OyJhcm0iCiIxMzkiOzQ7ImFybSIKIjE0MCI7NDsiYXJtIgoiMTQxIjs0OyJhcm0iCiIxNDIiOzQ7ImFybSIKIjE0MyI7NDsiYXJtIgoiMTQ0Ijs0OyJhcm0iCiIxNDUiOzQ7ImFybSIKIjE0NiI7NDsiYXJtIgoiMTQ3Ijs0OyJhcm0iCiIxNDgiOzQ7ImFybSIKIjE0OSI7NDsiYXJtIgoiMTUwIjs0OyJhcm0iCiIxNTEiOzQ7ImFybSIKIjE1MiI7NDsiYXJtIgoiMTUzIjs0OyJhcm0iCiIxNTQiOzQ7ImFybSIKIjE1NSI7NDsiYXJtIgoiMTU2Ijs0OyJhcm0iCiIxNTciOzQ7ImFybSIKIjE1OCI7NDsiYXJtIgoiMTU5Ijs0OyJhcm0iCiIxNjAiOzU7InJlaWNoIgoiMTYxIjs1OyJyZWljaCIKIjE2MiI7NTsicmVpY2giCiIxNjMiOzU7InJlaWNoIgoiMTY0Ijs1OyJyZWljaCIKIjE2NSI7NTsicmVpY2giCiIxNjYiOzU7InJlaWNoIgoiMTY3Ijs1OyJyZWljaCIKIjE2OCI7NTsicmVpY2giCiIxNjkiOzU7InJlaWNoIgoiMTcwIjs1OyJyZWljaCIKIjE3MSI7NTsicmVpY2giCiIxNzIiOzU7InJlaWNoIgoiMTczIjs1OyJyZWljaCIKIjE3NCI7NTsicmVpY2giCiIxNzUiOzU7InJlaWNoIgoiMTc2Ijs1OyJyZWljaCIKIjE3NyI7NTsicmVpY2giCiIxNzgiOzU7InJlaWNoIgoiMTc5Ijs1OyJyZWljaCIKIjE4MCI7NTsicmVpY2giCiIxODEiOzU7InJlaWNoIgoiMTgyIjs1OyJyZWljaCIKIjE4MyI7NTsicmVpY2giCiIxODQiOzU7InJlaWNoIgoiMTg1Ijs1OyJyZWljaCIKIjE4NiI7NTsicmVpY2giCiIxODciOzU7ImFybSIKIjE4OCI7NTsiYXJtIgoiMTg5Ijs1OyJhcm0iCiIxOTAiOzU7ImFybSIKIjE5MSI7NTsiYXJtIgoiMTkyIjs1OyJhcm0iCiIxOTMiOzU7ImFybSIKIjE5NCI7NTsiYXJtIgoiMTk1Ijs1OyJhcm0iCiIxOTYiOzU7ImFybSIKIjE5NyI7NTsiYXJtIgoiMTk4Ijs1OyJhcm0iCiIxOTkiOzU7ImFybSIKIjIwMCI7NTsiYXJtIgoiMjAxIjs1OyJhcm0iCiIyMDIiOzU7ImFybSIKIjIwMyI7NTsiYXJtIgoiMjA0Ijs1OyJhcm0iCiIyMDUiOzU7ImFybSIKIjIwNiI7NjsicmVpY2giCiIyMDciOzY7InJlaWNoIgoiMjA4Ijs2OyJyZWljaCIKIjIwOSI7NjsicmVpY2giCiIyMTAiOzY7ImFybSIKIjIxMSI7NjsiYXJtIgoiMjEyIjs2OyJhcm0iCg==" download="graeberbrz.csv">graeberbrz.csv</a></li>
</ul>
<p>First, let’s look at the data and inspect them:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>graeberbrz <span class="ot">&lt;-</span> <span class="fu">read.csv2</span>(<span class="st">"graeberbrz.csv"</span>,</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">row.names =</span> <span class="dv">1</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(graeberbrz)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  alter reichtum
1     1    reich
2     1    reich
3     1    reich
4     1    reich
5     1    reich
6     1    reich</code></pre>
</div>
</div>
<p>You can see, that in our dataset the age classes are coded using numbers starting from one for ‘infans I’ to 6 for ‘senilus’. Quite often it makes sense to recode ordinal variables in such a numerical way to make it accessible for calculations in R. With this recording, we achieved that the ordinal character preserved. We can use the table comand to display the full dataset with the frequency of burials in the different classes:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(graeberbrz)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     reichtum
alter arm reich
    1   6    23
    2   8    21
    3  11    25
    4  29    36
    5  19    27
    6   3     4</code></pre>
</div>
</div>
<p>For the <code>ks.test()</code>, which is the R command for conducting this test, it is convenient to take the data set apart into two vectors. The first vector will include the list of ages, the second vector will store the association with a specific wealth class.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> graeberbrz<span class="sc">$</span>alter</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 1 1 1 1 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>wealth <span class="ot">&lt;-</span> graeberbrz<span class="sc">$</span>reichtum</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(wealth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "reich" "reich" "reich" "reich" "reich" "reich"</code></pre>
</div>
</div>
<p>Using the wealth vector as access criterion, we will feed into the <code>ks.test()</code> command age classes of the rich and the poor graves separatly as two samples</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(age[wealth<span class="sc">==</span><span class="st">"arm"</span>],</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>        age[wealth<span class="sc">==</span><span class="st">"reich"</span>]</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>        )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ks.test.default(age[wealth == "arm"], age[wealth == "reich"]):
p-value will be approximate in the presence of ties</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic two-sample Kolmogorov-Smirnov test

data:  age[wealth == "arm"] and age[wealth == "reich"]
D = 0.178, p-value = 0.09
alternative hypothesis: two-sided</code></pre>
</div>
</div>
<p>You will see, that in the output the value D represents the maximum difference between the two samples that we also have calculated by hand. Additionally, you will see the P value that here is 0.09. So given the classical 0.05 significance level, we just have not reached enough certainty that we can speak about a patterned distribution with 95% security.</p>
<p>You also will see a warning, that there are ties. This means, that there are equal values in both samples present. In that case, exact P values cannot be calculated. This is only possible, if we have a metric variable instead of an ordinal ones, or a very large sample size (beyond 10000). For us, the approximated p-value is more than enough.</p>
<p>Lastly, you will see that the alternative hypothesis is two sided. This means, that by default the test assumes a two-tailed hypothesis. So in total, the test using R confirms our own calculation of the result: it is not significant.</p>
<section id="ks-test-excercise" class="level4">
<h4 class="anchored" data-anchor-id="ks-test-excercise">KS-test excercise</h4>
<p>You can try out what you have learned using this exercise:</p>
<div class="exercise">
<p>This dataset represents cups from ‘relative closed’ finds from late neolithic inventories (Müller 2001).</p>
<p>File: <a href="data:text/csv;base64,InRhc3NlbnR5cCI7ImhvZWhlIgoiZWluZ2xpZWRyaWciOzcsMgoiZWluZ2xpZWRyaWciOzkKImVpbmdsaWVkcmlnIjs1LDQKImVpbmdsaWVkcmlnIjsxMgoiZWluZ2xpZWRyaWciOzEyCiJlaW5nbGllZHJpZyI7NgoiendlaWdsaWVkcmlnIjsxNQoiendlaWdsaWVkcmlnIjs5CiJlaW5nbGllZHJpZyI7MTAsOAoiZWluZ2xpZWRyaWciOzgsNAoiZWluZ2xpZWRyaWciOzE0LDQKImVpbmdsaWVkcmlnIjs5LDkKInp3ZWlnbGllZHJpZyI7MjEKImVpbmdsaWVkcmlnIjsxMiw2CiJlaW5nbGllZHJpZyI7NywyCiJlaW5nbGllZHJpZyI7MTMsNQoiZWluZ2xpZWRyaWciOzEyCiJlaW5nbGllZHJpZyI7Myw5CiJlaW5nbGllZHJpZyI7MTUsNgoiZWluZ2xpZWRyaWciOzYsOQoiendlaWdsaWVkcmlnIjsxMCw1CiJlaW5nbGllZHJpZyI7MTIKImVpbmdsaWVkcmlnIjs2LDkKImVpbmdsaWVkcmlnIjsxMiw5CiJlaW5nbGllZHJpZyI7Myw2CiJ6d2VpZ2xpZWRyaWciOzEwLDUKInp3ZWlnbGllZHJpZyI7Niw2CiJ6d2VpZ2xpZWRyaWciOzcsNQoiendlaWdsaWVkcmlnIjsyNSw1CiJlaW5nbGllZHJpZyI7NgoiendlaWdsaWVkcmlnIjsxMiw2CiJlaW5nbGllZHJpZyI7OSw2CiJlaW5nbGllZHJpZyI7MTYsNQoiZWluZ2xpZWRyaWciOzYsNgoiendlaWdsaWVkcmlnIjs2CiJ6d2VpZ2xpZWRyaWciOzEwLDIKInp3ZWlnbGllZHJpZyI7MTIsNgoiZWluZ2xpZWRyaWciOzUsNAoiZWluZ2xpZWRyaWciOzE2LDUKImVpbmdsaWVkcmlnIjsxMSw0CiJlaW5nbGllZHJpZyI7MTEsNAoiendlaWdsaWVkcmlnIjsyMCw0CiJlaW5nbGllZHJpZyI7MjEsNgoiZWluZ2xpZWRyaWciOzkKImVpbmdsaWVkcmlnIjsxOAoiZWluZ2xpZWRyaWciOzcsMgoiZWluZ2xpZWRyaWciOzE4CiJlaW5nbGllZHJpZyI7Nyw1CiJlaW5nbGllZHJpZyI7MTIsOQoiZWluZ2xpZWRyaWciOzYsOQoiendlaWdsaWVkcmlnIjsxMgoiendlaWdsaWVkcmlnIjs3LDgKImVpbmdsaWVkcmlnIjs3LDgKInp3ZWlnbGllZHJpZyI7MTAsOAoiendlaWdsaWVkcmlnIjs5CiJ6d2VpZ2xpZWRyaWciOzIxCiJ6d2VpZ2xpZWRyaWciOzEzLDgKInp3ZWlnbGllZHJpZyI7NgoiZWluZ2xpZWRyaWciOzEwLDUKImVpbmdsaWVkcmlnIjs3LDUKImVpbmdsaWVkcmlnIjsxMgoiZWluZ2xpZWRyaWciOzkKInp3ZWlnbGllZHJpZyI7OSw2CiJ6d2VpZ2xpZWRyaWciOzgsNwoiendlaWdsaWVkcmlnIjs5LDYKInp3ZWlnbGllZHJpZyI7Nyw4CiJ6d2VpZ2xpZWRyaWciOzE1LDkKImVpbmdsaWVkcmlnIjs4LDEKInp3ZWlnbGllZHJpZyI7OSw2CiJlaW5nbGllZHJpZyI7MTAsMgoiZWluZ2xpZWRyaWciOzEzLDUKImVpbmdsaWVkcmlnIjs2LDYKImVpbmdsaWVkcmlnIjs5CiJ6d2VpZ2xpZWRyaWciOzEyCiJlaW5nbGllZHJpZyI7NSwxCiJ6d2VpZ2xpZWRyaWciOzEyCiJlaW5nbGllZHJpZyI7MjAsNAoiZWluZ2xpZWRyaWciOzE1CiJlaW5nbGllZHJpZyI7MTQsNAoiZWluZ2xpZWRyaWciOzEwLDgKImVpbmdsaWVkcmlnIjsxNCwxCiJlaW5nbGllZHJpZyI7Myw2CiJlaW5nbGllZHJpZyI7MTMsNQoiZWluZ2xpZWRyaWciOzcsMgoiZWluZ2xpZWRyaWciOzQsNQoiZWluZ2xpZWRyaWciOzcsNQoiZWluZ2xpZWRyaWciOzYsOQoiZWluZ2xpZWRyaWciOzEwLDUKImVpbmdsaWVkcmlnIjs1LDQKImVpbmdsaWVkcmlnIjs4LDQKImVpbmdsaWVkcmlnIjs1LDQKImVpbmdsaWVkcmlnIjsyMQoiZWluZ2xpZWRyaWciOzcsMgoiZWluZ2xpZWRyaWciOzIxLDYKImVpbmdsaWVkcmlnIjs0LDgKInp3ZWlnbGllZHJpZyI7MTAsMgoiendlaWdsaWVkcmlnIjsyMQoiendlaWdsaWVkcmlnIjsxMCwyCiJ6d2VpZ2xpZWRyaWciOzI1LDIKImVpbmdsaWVkcmlnIjsyMQoiZWluZ2xpZWRyaWciOzksOQoiendlaWdsaWVkcmlnIjsxMywyCiJ6d2VpZ2xpZWRyaWciOzgsNAoiZWluZ2xpZWRyaWciOzEzLDUKImVpbmdsaWVkcmlnIjs5CiJ6d2VpZ2xpZWRyaWciOzkK" download="mueller2001.csv">mueller2001.csv</a></p>
<p>If you inspect the dataset, you will see that it contains the height of cups and a classification whether there profile is subdivided by a break or not. Please analyse with the Kolmogorov-Smirnov-Test if the heigths of cups with and without breaks differ significant on a 0.05-level.</p>
</div>
<details>
<summary>
Solution
</summary>
<p>At first, we have to load our data and construct our two sample vectors. This time, we divide the data set in a slightly different way, to give you an alternative. But it would also work in the same manner like we divided the example of the burials. Note also, that this situation we have metric data, and not ordinal ones.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>cups <span class="ot">&lt;-</span> <span class="fu">read.csv2</span>(<span class="st">"mueller2001.csv"</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>cups.with_breaks <span class="ot">&lt;-</span> cups<span class="sc">$</span>hoehe[cups<span class="sc">$</span>tassentyp <span class="sc">==</span> <span class="st">"zweigliedrig"</span>]</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>cups.without_breaks <span class="ot">&lt;-</span> cups<span class="sc">$</span>hoehe[cups<span class="sc">$</span>tassentyp <span class="sc">==</span> <span class="st">"eingliedrig"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then, we performed a KS test.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(cups.with_breaks, cups.without_breaks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Exact two-sample Kolmogorov-Smirnov test

data:  cups.with_breaks and cups.without_breaks
D = 0.252, p-value = 0.058
alternative hypothesis: two-sided</code></pre>
</div>
</div>
<p>Also here, there is no significant difference between the two types of cups in respect to the height.</p>
</details>
</section>
</section>
</section>
<section id="interpretation-of-significance-tests" class="level2">
<h2 class="anchored" data-anchor-id="interpretation-of-significance-tests">Interpretation of significance tests</h2>
<section id="pay-attention-also-when-the-statistic-seem-to-be-clear" class="level3">
<h3 class="anchored" data-anchor-id="pay-attention-also-when-the-statistic-seem-to-be-clear">Pay attention also when the statistic seem to be clear</h3>
<p>As with every version of statistical tests, the quality of the results strongly depends on:</p>
<ul>
<li>Having the right data</li>
<li>Asking the right question</li>
</ul>
<p>So even a significant result probably doesn’t mean anything, if you have asked the wrong question. Here, science and domain knowledge is much more important then statistical knowledge!</p>
<p><strong>After the test as well as before the test: The interpretation determines the result!</strong></p>
<p>Also, what do you do with the significant results strongly depends on your interpretation. For example, if you analyse a dataset, you probably will find a lot of associations, especially if it is more complex. But not every dependence, not every association it’s meaningful! Remember that by definition you will get a significant result in every 20th test even if all underlying data are just random. This means:</p>
<p><strong>Statistically significant ≠ archaeologically significant!</strong></p>
<p>You have to make sure, that the results that you can obtain really something that could also have relevance in the life of prehistoric people to become relevant.</p>
<p>All in all:</p>
<p><strong>Statistical results stay statistical: significance is always probability that the choice of a hypothesis is correct, but there is also a probability that it is by chance…</strong></p>
</section>
<section id="statistical-association-not-mean-causal-association" class="level3">
<h3 class="anchored" data-anchor-id="statistical-association-not-mean-causal-association">Statistical association not mean causal association!</h3>
<p>The classic saying in statistics is that association does not mean causation. Even if there is really a pattern in the data, this could result from observed variables, all variables that you did not take into account when constructing your hypothesis.</p>
<p>One example according to the Stephen Shennan book is the association between grave size and sex of the buried individuals Although there might be a statistically significant association between grave size and sex, this could be caused by a third factor. Maybe mail individuals have just bigger body height, making it necessary to dig bigger burial pits so that they can fit in. A conclusion which says that grave size are causally determined by sex would be at least not correct.</p>
<p><img src="../images/06_session/hidden_third.png" class="img-fluid"></p>
<p>Always, doing statistical analyses does not save you from making your own thoughs and trying to contact good science!</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>